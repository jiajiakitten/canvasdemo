<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
    <title>canvas变换</title>
    <style type="text/css">
        .center{
            width:800px;
            margin: 0 auto;
        }
        #trascanvas{
            border:1px solid #666;
            
            
        }
    </style>
</head>
<body>
<div class="center">
    <h5>旋转</h5>
    <canvas id="trascanvas0" width="800" height="400"></canvas>
    <h5>平移</h5>
    <canvas id="trascanvas1" width="800" height="400"></canvas>
    <h5>缩放</h5>
    <canvas id="trascanvas2" width="800" height="400"></canvas>
    <h5>矩阵变换</h5>
    <canvas id="trascanvas3" width="800" height="400"></canvas>
    <h5>合成</h5>
    <div style="margin-bottom: 40px; ">
        <span>合成方式：</span>
    <select id="gco" onchange=cxt_gco(this.value)>
        <option value="source-over">source-over</option>
        <option value="source-atop">source-atop</option>
        <option value="source-in">source-in </option>
        <option value="source-out">source-out </option>
        <option value="destination-over">destination-over </option>
        <option value="destination-in">destination-in</option>
        <option value="destination-atop">destination-atop</option>
         <option value="destination-out">destination-out</option>
          <option value="lighter">lighter</option>
           <option value="copy">copy</option>
            <option value="xor">xor</option>

    </select>
    </div>
    
    <canvas id="trascanvas4" width="800" height="400"></canvas>
</div>
<script type="text/javascript">
function cxt_rotate() {
        var ctx = document.getElementById("trascanvas0").getContext("2d");
        ctx.save();
        ctx.fillStyle="#396";
        var angle=-45*Math.PI/180;
        ctx.translate(150,150);
        ctx.rotate(angle);
        ctx.fillRect(-75,-50,100,100);
        ctx.restore();


};
function cxt_translate() {
        var ctx = document.getElementById("trascanvas1").getContext("2d");
        ctx.fillStyle="#987";
        ctx.translate(100,200);
        ctx.fillRect(0,0,50,100);

};
function cxt_scale() {
        var ctx = document.getElementById("trascanvas2").getContext("2d");
        ctx.fillStyle="#666";
        ctx.fillRect(0,0,100,100);
        ctx.fillStyle="#693";
        ctx.scale(2,2);
        ctx.globalCompositeOperation ="destination-atop";
        ctx.fillRect(0,0,100,100);
        
};
function cxt_transform() {
        var ctx = document.getElementById("trascanvas3").getContext("2d");
        ctx.save();
        ctx.fillStyle="yellow";
        ctx.fillRect(0,0,250,100)

        ctx.setTransform(1,0.5,-0.5,1,30,10);
        ctx.fillStyle="red";
        ctx.fillRect(0,0,250,100);

        ctx.setTransform(1,0.5,-0.5,1,30,10);
        ctx.fillStyle="blue";
        ctx.fillRect(0,0,250,100);

        ctx.restore();
        //ctx.setTransform(1,0,0,1,0,0);

        ctx.fillStyle="yellow";
        ctx.translate(300,0);
        ctx.fillRect(0,0,250,100);


};
function cxt_gco(type) {
        var ctx = document.getElementById("trascanvas4").getContext("2d");
        ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height);
        ctx.save();
        switch(type){
            case 'xor': ctx.fillStyle="#666";
                        ctx.fillRect(50,50,300,300);
                        ctx.fillStyle="#693";
                        ctx.globalCompositeOperation = type;
                        ctx.fillRect(0,0,100,100);
                        break;
            case 'source-over':ctx.fillStyle="#666";
                        ctx.fillRect(50,50,300,300);
                        ctx.fillStyle="#693";
                        ctx.globalCompositeOperation = type;
                        console.log(type);
                        ctx.fillRect(0,0,100,100);
                        break;
            default:ctx.fillStyle="#666";
                        ctx.fillRect(50,50,300,300);
                        ctx.fillStyle="#693";
                        ctx.globalCompositeOperation = type;
                        ctx.fillRect(0,0,100,100);
                        break;
        }
        ctx.restore();
        
};
cxt_rotate();
cxt_translate();
cxt_scale();
cxt_transform();

cxt_gco('source-over');




</script>
<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan style='display:none' id='cnzz_stat_icon_1260969503'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s11.cnzz.com/z_stat.php%3Fid%3D1260969503' type='text/javascript'%3E%3C/script%3E"));</script>

</body>
</html>